"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _consts = require("../consts");
var _helpers = require("../helpers");
var _default = (store, api, sharedActions) => {
  const actions = sharedActions;

  /**
   * Step up for hosted login apps
   * @param payload.maxAge
   */
  const stepUpHostedLogin = async payload => {
    var _store$auth$tenantsSt, _store$auth$tenantsSt2;
    const params = {
      acr_values: _consts.ACR_VALUE
    };
    const {
      maxAge
    } = payload || {};
    if (maxAge !== undefined) {
      params['max_age'] = maxAge.toString();
    }
    const alias = (_store$auth$tenantsSt = store.auth.tenantsState) == null ? void 0 : (_store$auth$tenantsSt2 = _store$auth$tenantsSt.activeTenant) == null ? void 0 : _store$auth$tenantsSt2.alias;
    if (alias) {
      params['organization'] = alias;
    }
    (0, _helpers.setAfterAuthRedirectUrlForStepUp)();
    window.localStorage.setItem(_consts.SHOULD_STEP_UP_KEY, 'true');
    await actions.__requestHostedLoginAuthorize(params);
  };
  return {
    stepUpHostedLogin
  };
};
exports.default = _default;